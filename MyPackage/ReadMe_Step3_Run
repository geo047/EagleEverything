# setup
set.seed(101)
n <- 60000
ngpu <- 4
res   <- matrix(sample(1:1000, n*n, T), nrow=n)
# res  <- tcrossprod(res)  ## turns matrix into symmetric matrix


## Testing of magmaQR
library(Eagle)
start <- Sys.time()
qGPU  <- magmaQR(res, ngpu=ngpu, printInfo=TRUE)
end  <- Sys.time()
print(end - start)

 ## CPU 
start <- Sys.time()
qCPU  <- qr.Q(qr(res))
end  <- Sys.time()
print(end - start)

print(qGPU[1:5, 1:5])
print("---------------------")
print(qCPU[1:5, 1:5])

print(sum(qGPU-qCPU))






