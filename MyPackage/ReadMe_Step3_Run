library(Eagle)
# setup
set.seed(101)
n <- 5
ngpu <- 4
res   <- matrix(sample(c(0,1), n*n, T), nrow=n)
#res  <- tcrossprod(K)

start <- Sys.time()
qGPU  <- magmaQR(res, ngpu=4, printInfo=TRUE)
end  <- Sys.time()
print(end - start)





 ## CPU 
start <- Sys.time()
qCPU  <- qr.Q(qr(res))
end  <- Sys.time()
print(end - start)


print(qGPU[1:5, 1:5])
print("---------------------")
print(qCPU[1:5, 1:5])


print(sum(qGPU-qCPU))






